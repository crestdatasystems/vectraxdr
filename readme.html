<!-- File: readme.html
   Copyright (c) 2023 Vectra
   
   This unpublished material is proprietary to Vectra.
   All rights reserved. The methods and
   techniques described herein are considered trade secrets
   and/or confidential. Reproduction or distribution, in whole
   or in part, is forbidden except by express written permission
   of Vectra.
   
   Licensed under the Apache License, Version 2.0 (the "License");
   you may not use this file except in compliance with the License.
   You may obtain a copy of the License at
   
       http://www.apache.org/licenses/LICENSE-2.0
   
   Unless required by applicable law or agreed to in writing, software distributed under
   the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,
   either express or implied. See the License for the specific language governing permissions
   and limitations under the License.
   -->
<h2>Explanation of the Asset Configuration Parameters</h2>
The asset configuration parameters affect 'test connectivity' and some other
actions of the application. The parameters
related to test connectivity action are metioned below.
<ul>
   <li>
      <b>Vectra Base URL: </b> Base URL of Vectra instance.
   </li>
   <li>
      <b>Client ID: </b> Client ID.
   </li>
   <li>
      <b>Client Secret: </b> Client Secret.
   </li>
</ul>
<h2>Explanation of the Actions' Parameters</h2>
<ul>
   <li>
      <h3>Test Connectivity</h3>
      This action will check the status of the Vectra API endpoint and test
      connectivity of Splunk SOAR to the Vectra
      instance. It can be used to generate new tokens.<br />
      The action validates the provided asset configuration parameters. Based on
      the response from the API call, the
      appropriate success and failure message will be displayed when the action
      gets executed.
   </li>
   <li>
      <h3>On Poll</h3>
      Polling is to ingest the entity and it's detections and assignments. The
      user can provide various filters for
      entities
      and detections.
      <h3>Prerequisite for On Poll</h3>
      <ul>
         <li>
            This app should have permission to delete artifact(s)
         </li>
         <li>
            By default, the automation user is selected to run the Vectra XDR for Splunk SOAR ingestion action. (See
            <b>Asset Configuration</b>><b>Asset Settings</b>><b>Advanced</b>)
            The automation user does <b>NOT</b> have permission to delete the artifacts.
            This can cause duplication of detection artifacts.
         </li>
         <li>
            In order to solve this problem, you must create a user of type <b>Automation</b> with <b>Administrator</b>
            role. Then, choose this user in your Vectra XDR for Splunk SOAR <b>Asset Settings</b>
            under <b>Advanced</b>.
            <br><br>
            <b>Administration</b>><b>User Management</b>><b>Users</b><b>> + User</b>
            <br><br>
            <a href="/app_resource/vectraxdrsplunksoar_fce4056c-6b35-4ecd-a900-896ad72d32fe/img/create_role.png">
               <img src="/app_resource/vectraxdrsplunksoar_fce4056c-6b35-4ecd-a900-896ad72d32fe/img/create_role.png" />
            </a>
            <br><br><br>
            <b>Asset Settings</b> > <b>Advanced</b>
            <br><br>
            <a href="/app_resource/vectraxdrsplunksoar_fce4056c-6b35-4ecd-a900-896ad72d32fe/img/asset_settings.png">
               <img src="/app_resource/vectraxdrsplunksoar_fce4056c-6b35-4ecd-a900-896ad72d32fe/img/asset_settings.png" />
            </a>
            <br><br><br>
         <li>
            Make sure severity low, medium, and high is present in soar instance, which comes by default.
         <br>
            <b>NOTE: </b>To check severity refer this path: <b>Administration</b> > <b>Event Settings</b> > <b>Severity</b><b>
   </li>
</ul>
<br>
<ul>
   <li>Manual Polling (POLL NOW)</b></li>
   <ul>
      <li>It will fetch the data when initiated, as per the corresponding
         asset configuration parameters. It does not
         store the last run context of the fetched data.
      </li>
   </ul>
   <li><b>Schedule/Interval Polling</b></li>
   <ul>
      <li><b>Schedule Polling:</b> The ingestion action can be triggered at
         every specified time interval.
      </li>
      <li><b>Interval Polling:</b> The ingestion action can be triggered at
         every time range interval.
      </li>
      <li>It will fetch the data every time, based on the stored context from
         the previous ingestion run. It stores
         the last run context of the fetched data. It starts fetching data
         based on the combination of the values of
         stored context for the previous ingestion run.
      </li>
      <li><b>NOTE:</b> If the user changes the filter related parameter or
         stored context while the schedule/interval
         polling is running, then the next polling cycle will start fetching
         the latest data according to the updated
         configured parameters.
      </li>
   </ul>
</ul>
<ul>
   <li><b>Action Parameter: Poll only prioritized entities</b></li>
   <ul>
      <li>This parameter has three options - True, False and All.
      </li>
      <li>If value is set to True then it will fetch those entities which are prioritized.
      </li>
      <li>If value is set to False then it will fetch those entities which are not
         prioritized.
      </li>
      <li>If value is set to All then it will fetch all the entities.
      </li>
      <li>These parameters are mainly used for additional filtering of
         entities. If no entity will be found with this
         filter, there would be no detection or assignments ingested.
      </li>
   </ul>
   <li><b>Action Parameter: Entity type (On Poll)</b></li>
   <ul>
      <li>This parameter has three options - Account, Host and All.
      </li>
      <li>These parameters are mainly used for additional filtering of
         entities. If no entity will be found with given
         entity type, there would be no detection or assignments ingested.
      </li>
   </ul>
   <li><b>Action Parameter: Filter entities with given tags (comma-separated) (On Poll)</b></li>
   <ul>
      <li>This parameter accepts comma-separated names of the entity tags.
      </li>
      <li>This will filter entities which have any of the given tags.
      </li>
      <li><b>NOTE:</b> This asset parameter is case-sensitive and the user
         must provide the exact case match.
   </ul>
   </li>
   <li><b>Action Parameter: Filter detection type (On Poll)</b></li>
   <ul>
      <li>This will filter detections with given type.
      </li>
      <li>These parameters are mainly used for additional filtering of
         detections. If no detections will be found with
         given filter there would be no detections ingested.
      </li>
      <li><b>NOTE:</b> This asset parameter is case-sensitive and the user
         must provide the exact case match.
      </li>
   </ul>
   <li><b>Action Parameter: Filter detection category (On Poll)</b></li>
   <ul>
      <li>
         This parameter has these options
         <ul>
            <li>Command and Control</li>
            <li>Botnet</li>
            <li>Reconnaissance</li>
            <li>Lateral Movement</li>
            <li>Exfiltration</li>
            <li>Info</li>
            <li>All</li>
         </ul>
      </li>
      <li>These parameters are mainly used for additional filtering of
         detections. If no detections will be found with
         given filter there would be no detections ingested.
      </li>
   </ul>
   <li><b>Action Parameter: Set container severity 'low' if entity has equal
         or less urgency score</b>
   </li>
   <ul>
      <li>
         If value of entity's urgency score is less or equal to this parameter
         the container's severity will be set to
         'low'.
      </li>
      <li>
         The default value is 30.
      </li>
   </ul>
   <li><b>Action Parameter: Set container severity 'medium' if entity has
         equal or less urgency score</b>
   </li>
   <ul>
      <li>
         If value of entity's urgency score is less or equal to this parameter
         the container's severity will be set to
         'medium'.
      </li>
      <li>
         The default value is 50.
      </li>
   </ul>
   <li><b>Action Parameter: Start time for manual polling and first run of schedule polling(Any valid ISO date and time format string)</b></li>
   <ul>
      <li>
         Schedule polling will start from given date and time. In case of schedule poll, this time will be considered for the very first polling cycle only. If the user changes this value after the first polling cycle, there won't be any effect as the time stored in state file will be prioritised after first polling cycle.
      </li>
      <li>
         All entities would be fetched which have 'last_modified_timestamp'
         greater or equal to given data and time.
      </li>
      <li>
         Only valid ISO format date and time is allowed. Few examples are
         2023-02-02, 2023-07-24T14:13:34Z.
      </li>
      <li>
         If value is not given it will fetch past 3 days data from the current time.
      </li>
   </ul>
   <li><b>Action Parameter: Max entities to ingest for manual polling</b></li>
   <ul>
      <li>
         Restrict number of container(s) to get ingested for manual poll.
      </li>
   </ul>
   <li><b>Action Parameter: Max entities to ingest for schedule polling</b></li>
   <ul>
      <li>
         Restrict number of container(s) to get ingested for schedule poll.
      </li>
   </ul>
   </li>
</ul>
<li>
   <h3>Add tags</h3>
   Appends tags on existing tags of an entity
   <ul>
      <li><b>Action Parameter: Entity ID</b></li>
      <ul>
         <li>Id of entity</li>
      </ul>
      <li><b>Action Parameter: Entity type</b></li>
      <ul>
         <li>Type of entity</li>
         <li>This parameter has 2 options - Account and Host</li>
      </ul>
      <li><b>Action Parameter: Tags list</b></li>
      <ul>
         <li>This parameter accepts comma-separated values for tags to be added</li>
      </ul>
   </ul>
</li>
<li>
   <h3>Remove tags</h3>
   Removes tags from existing tags of an entity
   <ul>
      <li><b>Action Parameter: Entity ID</b></li>
      <ul>
         <li>Id of entity</li>
      </ul>
      <li><b>Action Parameter: Entity type</b></li>
      <ul>
         <li>Type of entity</li>
         <li>This parameter has 2 options - Account and Host</li>
      </ul>
      <li><b>Action Parameter: tags list</b></li>
      <ul>
         <li>This parameter accepts comma-separated values for tags to be removed</li>
      </ul>
   </ul>
</li>
<li>
   <h3>Add note</h3>
   Adds note in specific entity
   <ul>
      <li><b>Action Parameter: Entity ID</b></li>
      <ul>
         <li>Id of entity</li>
      </ul>
      <li><b>Action Parameter: Entity type</b></li>
      <ul>
         <li>Type of entity</li>
         <li>This parameter has 2 options - Account and Host</li>
      </ul>
      <li><b>Action Parameter: Note</b></li>
      <ul>
         <li>A note to be added in given entity</li>
      </ul>
   </ul>
<li>
   <h3>Remove note</h3>
   Removes note in specific entity
   <ul>
      <li><b>Action Parameter: Entity ID</b></li>
      <ul>
         <li>Id of entity</li>
      </ul>
      <li><b>Action Parameter: Entity type</b></li>
      <ul>
         <li>Type of entity</li>
         <li>This parameter has 2 options - Account and Host</li>
      </ul>
      <li><b>Action Parameter: Note ID</b></li>
      <ul>
         <li>Id of note to be removed</li>
      </ul>
   </ul>
<li>
   <h3>Update note</h3>
   Updates note in specific entity
   <ul>
      <li><b>Action Parameter: Entity ID</b></li>
      <ul>
         <li>Id of entity</li>
      </ul>
      <li><b>Action Parameter: Entity type</b></li>
      <ul>
         <li>Type of entity</li>
         <li>This parameter has 2 options - Account and Host</li>
      </ul>
      <li><b>Action Parameter: Note ID of the note</b></li>
      <ul>
         <li>Note ID</li>
      </ul>
      <li><b>Action Parameter: Note</b></li>
      <ul>
         <li>Note to be updated</li>
      </ul>
   </ul>
<li>
   <h3>Add assignment</h3>
   Creates assignment for given entity id and user id
   <ul>
      <li><b>Action Parameter: Entity ID</b></li>
      <ul>
         <li>Id of entity</li>
      </ul>
      <li><b>Action Parameter: Entity type</b></li>
      <ul>
         <li>Type of entity</li>
         <li>This parameter has 2 options - Account and Host</li>
      </ul>
      <li><b>Action Parameter:User ID</b></li>
      <ul>
         <li>User ID for given assignment</li>
      </ul>
   </ul>
<li>
   <h3>Update assignment</h3>
   Updated assignment for given assignment id and user id
   <ul>
      <li><b>Action Parameter: Assignment ID</b></li>
      <ul>
         <li>Id of assignment</li>
      </ul>
      <li><b>Action Parameter:User ID</b></li>
      <ul>
         <li>User ID for given assignment</li>
      </ul>
   </ul>
<li>
   <h3>Resolve assignment</h3>
   Resolves assignment of an entity
   <ul>
      <li><b>Action Parameter: Outcome</b></li>
      <ul>
         <li>Valid outcome to add as resolution</li>
      </ul>
      <li><b>Action Parameter: Note</b></li>
      <ul>
         <li>Note to be added</li>
      </ul>
      <li><b>Action Parameter: Triage as</b></li>
      <ul>
         <li>Label for resolution</li>
      </ul>
      <li><b>Action Parameter: Detection IDs</b></li>
      <ul>
         <li>Comma separated list of detection ids</li>
      </ul>
      <li><b>Action Parameter: Assignment ID</b></li>
      <ul>
         <li>ID of assignment</li>
      </ul>
   </ul>
<li>

   <h3>Mark entity detections</h3>
   Be able to mark all detections of an entity as fixed
   <ul>
      <li><b>Action Parameter: Entity ID</b></li>
      <ul>
         <li>Id of entity</li>
      </ul>
      <li><b>Action Parameter: Entity type</b></li>
      <ul>
         <li>Type of entity</li>
         <li>This parameter has 2 options - Account and Host</li>
      </ul>
   </ul>
<li>
   <h3>Mark detection</h3>
   Mark the status of detection as fixed
   <ul>
      <li><b>Action Parameter: Detection ID</b></li>
      <ul>
         <li>Id of detection</li>
      </ul>
   </ul>
<li>
   <h3>Unmark detection</h3>
   Unmark the status of detection
   <ul>
      <li><b>Action Parameter: Detection ID</b></li>
      <ul>
         <li>Id of detection</li>
      </ul>
   </ul>
<li>
   <h3>Describe entity</h3>
   Gets all the details of given entity id
   <ul>
      <li><b>Action Parameter: Entity ID</b></li>
      <ul>
         <li>Id of entity</li>
      </ul>
      <li><b>Action Parameter: Entity type</b></li>
      <ul>
         <li>Type of entity</li>
         <li>This parameter has 2 options - Account and Host</li>
      </ul>
   </ul>
<li>
   <h3>Describe detection</h3>
   Gets all the details of given detection id
   <ul>
      <li><b>Action Parameter: Detection ID</b></li>
      <ul>
         <li>Id of detection</li>
      </ul>
   </ul>
<li>
   <h3>List entity detections</h3>
   The action is able to list all active detections present in an entity
   <ul>
      <li><b>Action Parameter: Entity ID</b></li>
      <ul>
         <li>Id of entity</li>
      </ul>
      <li><b>Action Parameter: Entity type</b></li>
      <ul>
         <li>Type of entity</li>
         <li>This parameter has 2 options - Account and Host</li>
      </ul>
   </ul>
<li>
   <h3>Download PCAP</h3>
   The action is able to download PCAP of a detection
   <ul>
      <li><b>Action Parameter: Detection ID</b></li>
      <ul>
         <li>Id of detection</li>
      </ul>
   </ul>